name: Publish Python distribution to PyPI
description: Build and publish the Python package from Server/ to PyPI
runs:
  using: composite
  steps:
    - name: Install uv
      uses: astral-sh/setup-uv@v7
      with:
        version: "latest"
        enable-cache: true
        cache-dependency-glob: "Server/uv.lock"

    - name: Build a binary wheel and a source tarball
      shell: bash
      run: uv build
      working-directory: ./Server

    - name: Publish distribution to PyPI
      # Pin to v1.12.4 to avoid Docker container name issue with uppercase repo names in v1.13.0+
      uses: pypa/gh-action-pypi-publish@v1.12.4
      with:
        packages-dir: Server/dist/
